<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.user">
<!-- 리절트 맵 정의 -->	
	<resultMap id="userResult" type="UserVO">
		<result property="user_id" column="user_id" />
		<result property="user_pw" column="user_pw" />
		<result property="user_name" column="user_name" />
		
		<result property="tel1" column="tel1" />
		<result property="tel2" column="tel2" />
		<result property="tel3" column="tel3" />
		
		<result property="hp1" column="hp1" />
		<result property="hp2" column="hp2" />
		<result property="hp3" column="hp3" />
		<result property="email1" column="email1" />
		<result property="email2" column="email2" />
		<result property="emailsts_yn" column="emailsts_yn" />
		
		<result property="mileage" column="mileage" />
		
		<result property="roadAddress" column="roadAddress" />
		<result property="user_role" column="user_role" />
		<result property="join_date" column="join_date" />
		<result property="join_state" column="join_state" />
		<result property="quit_date" column="quit_date" />
		<result property="company_registration_number" column="company_registration_number" />
	</resultMap>	

	<select id="login" resultMap="userResult"  parameterType="UserVO">
	    <![CDATA[
			select * from `user` 
			 where user_id=#{user_id}
			 and user_pw=#{user_pw}				 
		]]>
	</select>
	<insert id="register" parameterType="UserVO">
		
		<![CDATA[
			insert into `user`
		]]>
			<if test="user_role == 'normal_user'">
				<![CDATA[
					(user_id,user_pw,user_name,phonenum1,phonenum2,phonenum3,user_email,user_role,join_state,sns_account)
					values(
						#{user_id},#{user_pw},#{user_name},#{phonenum1},#{phonenum2},#{phonenum3},#{user_email},#{user_role},#{join_state},#{sns_account}
					) 
				]]>
			</if>
			<if test="user_role == 'cafe_manager'">
				<![CDATA[
					(user_id,user_pw,user_name,phonenum1,phonenum2,phonenum3,user_email,user_role,join_state,company_registration_number,sns_account)
					values(
						#{user_id},#{user_pw},#{user_name},#{phonenum1},#{phonenum2},#{phonenum3},#{user_email},#{user_role},#{join_state},#{company_registration_number},#{sns_account}
					)
				]]>
			</if>
							 
		
	</insert>
	<select id="userOverlapCheck" resultType="string"  parameterType="UserVO">
	    <![CDATA[
			select (case count(*)
			      when 1 then 'true'
			      when 0 then 'false'
			      end) from `user` 
			where user_id=#{user_id};
		]]>
	</select>
	<select id="getUserPassword" resultType="string"  parameterType="string">
	    <![CDATA[
			select user_pw 
			from `user` 
			where user_id=#{user_id};
		]]>
	</select>
	<select id="selectAllUser" resultMap="userResult" parameterType="string">
		<![CDATA[
			select * 
			from `user`
		]]>
		<if test="user_role!=null and user_role!=''"> 
			<![CDATA[
				where user_role=#{user_role};
			]]>
		</if>
	
	</select>
</mapper>